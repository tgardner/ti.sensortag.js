require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a){this.peripheral=a}b.exports=c},{}],2:[function(a,b){var c=a("./Connector"),d=function(a,b){c.call(this,a),this.ble=b};d.prototype=new c,d.prototype.constructor=d,d.prototype.services=function(a,b){this.ble.services(this.peripheral,a,b)},d.prototype.characteristics=function(a,b,c){this.ble.characteristics(this.peripheral,a.handle,b,c)},d.prototype.descriptors=function(a,b,c){this.ble.descriptors(this.peripheral,a.handle,b,c)},d.prototype.writeCharacteristic=function(a,b,c,d){this.ble.writeCharacteristic(this.peripheral,a.handle,c,d)},d.prototype.readCharacteristic=function(a,b,c){this.ble.readCharacteristic(this.peripheral,a.handle,b,c)},d.prototype.writeDescriptor=function(a,b,c,d){this.ble.writeDescriptor(this.peripheral,a.handle,c,d)},d.prototype.enableNotification=function(a,b,c){this.ble.enableNotification(this.peripheral,a.handle,b,c)},d.prototype.disableNotification=function(a,b,c){this.ble.disableNotification(this.peripheral,a.handle,b,c)},d.prototype.close=function(){this.ble.close(this.peripheral)},d.prototype.toString=function(){return this.peripheral},b.exports=d},{"./Connector":1}],3:[function(a,b){var c=a("./Connector"),d=function(a){c.call(this,a)};d.prototype=new c,d.prototype.constructor=d,d.prototype.services=function(a,b){this.peripheral.discoverServices([],function(c,d){c?b(c):a(d)})},d.prototype.characteristics=function(a,b,c){a.discoverCharacteristics([],function(a,d){a?c(a):b(d)})},d.prototype.descriptors=function(a,b,c){a.discoverDescriptors(function(a,d){a?c(a):b(d)})},d.prototype.writeCharacteristic=function(a,b,c,d){var e=new Buffer(b);a.write(e,!0,function(a){a?d(a):c()})},d.prototype.readCharacteristic=function(a,b,c){a.read(function(a,d){a?c(a):b(d)})},d.prototype.writeDescriptor=function(a,b,c,d){var e=new Buffer(b);a.writeValue(e,function(a){a?d(a):c()})},d.prototype.enableNotification=function(a,b,c){a.on("read",b),a.notify(!0,function(a){a&&c(a)})},d.prototype.disableNotification=function(a,b,c){a.notify(!1,function(a){a?c(a):b()})},d.prototype.close=function(){var a=this;a.peripheral.disconnect()},d.prototype.toString=function(){return this.peripheral.uuid},b.exports=d},{"./Connector":1}],4:[function(a,b){b.exports={GATT_CLIENT_CHAR_CFG_UUID:/^(0000)?2902(-0000-1000-8000-00805f9b34fb)?$/,ACCELEROMETER_UUID_SERVICE:"f000aa10-0451-4000-b000-000000000000",ACCELEROMETER_UUID_DATA:/^f000aa11-0451-4000-b000-000000000000$/,ACCELEROMETER_UUID_CONF:"f000aa12-0451-4000-b000-000000000000",ACCELEROMETER_UUID_PERIOD:"f000aa13-0451-4000-b000-000000000000",BAROMETRICPRESSURE_UUID_SERVICE:"f000aa40-0451-4000-b000-000000000000",BAROMETRICPRESSURE_UUID_DATA:/^f000aa41-0451-4000-b000-000000000000$/,BAROMETRICPRESSURE_UUID_CONF:"f000aa42-0451-4000-b000-000000000000",BAROMETRICPRESSURE_UUID_PERIOD:"f000aa44-0451-4000-b000-000000000000",BAROMETRICPRESSURE_UUID_CALIBRATION:/^f000aa43-0451-4000-b000-000000000000$/,GYROSCOPE_UUID_SERVICE:"f000aa50-0451-4000-b000-000000000000",GYROSCOPE_UUID_DATA:/^f000aa51-0451-4000-b000-000000000000$/,GYROSCOPE_UUID_CONF:"f000aa52-0451-4000-b000-000000000000",GYROSCOPE_UUID_PERIOD:"f000aa53-0451-4000-b000-000000000000",HUMIDITY_UUID_SERVICE:"f000aa20-0451-4000-b000-000000000000",HUMIDITY_UUID_DATA:/^f000aa21-0451-4000-b000-000000000000$/,HUMIDITY_UUID_CONF:"f000aa22-0451-4000-b000-000000000000",HUMIDITY_UUID_PERIOD:"f000aa23-0451-4000-b000-000000000000",IRTEMPERATURE_UUID_SERVICE:"f000aa00-0451-4000-b000-000000000000",IRTEMPERATURE_UUID_DATA:/^f000aa01-0451-4000-b000-000000000000$/,IRTEMPERATURE_UUID_CONF:"f000aa02-0451-4000-b000-000000000000",IRTEMPERATURE_UUID_PERIOD:"f000aa03-0451-4000-b000-000000000000",MAGNETOMETER_UUID_SERVICE:"f000aa30-0451-4000-b000-000000000000",MAGNETOMETER_UUID_DATA:/^f000aa31-0451-4000-b000-000000000000$/,MAGNETOMETER_UUID_CONF:"f000aa32-0451-4000-b000-000000000000",MAGNETOMETER_UUID_PERIOD:"f000aa33-0451-4000-b000-000000000000",SIMPLEKEY_UUID_SERVICE:/^(0000)?ffe0(-0000-1000-8000-00805f9b34fb)?$/,SIMPLEKEY_UUID_DATA:/^(0000)?ffe1(-0000-1000-8000-00805f9b34fb)?$/,GUID_PATTERN:/([a-f0-9]{8})-?([a-f0-9]{4})-?([a-f0-9]{4})-?([a-f0-9]{4})-?([a-f0-9]{12})/,GUID_REPLACEMENT:"$1-$2-$3-$4-$5"}},{}],5:[function(a,b){var c=a("./Constants.js"),d=function(a,b,c,d,e){this.identifier=a,this.sensorTag=b,this.UUID_DATA=c,this.UUID_CONF=d,this.UUID_PERIOD=e,this.enabled=!1,this.characteristics={config:null,period:null,data:null},this.descriptors={notification:null},this._listeners=[]};d.prototype.init=function(a){for(var b in a.characteristics){var d=a.characteristics[b],e=d.uuid.replace(c.GUID_PATTERN,c.GUID_REPLACEMENT);switch(e){case this.UUID_CONF:this.characteristics.config=d;break;case this.UUID_PERIOD:this.characteristics.period=d}if(this.UUID_DATA.test(e)){this.characteristics.data=d;for(var f in d.descriptors){var g=d.descriptors[f],h=g.uuid.replace(c.GUID_PATTERN,c.GUID_REPLACEMENT);c.GATT_CLIENT_CHAR_CFG_UUID.test(h)&&(this.descriptors.notification=g)}}}this.log("Initialized")},d.prototype.log=function(a){this.sensorTag.log(this.identifier+": "+a)},d.prototype.enable=function(a){var b=1,c=this;c.sensorTag.device.writeCharacteristic(c.characteristics.config,new Uint8Array([a||b]),function(){c.enabled=!0,c.log("Enabled")},function(a){c.log("enable error: "+a)})},d.prototype.disable=function(){var a=0,b=this;b.sensorTag.device.writeCharacteristic(b.characteristics.config,new Uint8Array([a]),function(){b.enabled=!0,b.log("Disabled")},function(a){b.log("disable error: "+a)})},d.prototype.enableNotification=function(){var a=[1,0],b=this;b.sensorTag.device.writeDescriptor(b.descriptors.notification,new Uint8Array(a),function(){b.log("Notifications enabled")},function(a){b.log("enableNotifications write error: "+a)}),b.sensorTag.device.enableNotification(b.characteristics.data,function(){b.onDataNotify.apply(b,arguments)},function(a){b.log("enableNotifications subscribe error: "+a)})},d.prototype.disableNotification=function(){var a=[0,0],b=this;b.sensorTag.device.writeDescriptor(b.descriptors.notification,new Uint8Array(a),function(){b.log("Notifications disabled")},function(a){b.log("disableNotification write error: "+a)}),b.sensorTag.device.disableNotification(b.characteristics.data,function(){},function(a){b.log("disableNotification subscribe error: "+a)})},d.prototype.addListener=function(a){return this._listeners.push(a),this._listeners.length-1},d.prototype.removeListener=function(a){this._listeners.splice(a,1)},d.prototype.onDataNotify=function(){for(var a in this._listeners){var b=this._listeners[a];b.apply(this,arguments)}},b.exports=d},{"./Constants.js":4}],SensorTag:[function(a,b){b.exports=a("T6zdoz")},{}],T6zdoz:[function(a,b){function c(){++h}function d(){--h}var e=a("./Constants"),f=a("./Connectors/Connector"),g=function(a){if(!(a instanceof f))throw"Invalid device connector";this.device=a,this.services=[],this.Accelerometer=new g.Accelerometer(this),this.BarometricPressure=new g.BarometricPressure(this),this.Gyroscope=new g.Gyroscope(this),this.Humidity=new g.Humidity(this),this.IRTemperature=new g.IRTemperature(this),this.Magnetometer=new g.Magnetometer(this),this.SimpleKey=new g.SimpleKey(this)};g.Accelerometer=a("./Sensors/Accelerometer"),g.BarometricPressure=a("./Sensors/BarometricPressure"),g.Gyroscope=a("./Sensors/Gyroscope"),g.Humidity=a("./Sensors/Humidity"),g.IRTemperature=a("./Sensors/Humidity"),g.Magnetometer=a("./Sensors/Magnetometer"),g.SimpleKey=a("./Sensors/SimpleKey"),g.NobleConnector=a("./Connectors/NobleConnector"),g.EvothingsConnector=a("./Connectors/EvothingsConnector"),g.prototype.log=function(a){console.log("SensorTag #"+this.device+" "+a)},g.prototype.init=function(){for(var a=this,b=0;b<a.services.length;++b){var c=a.services[b],d=c.uuid.replace(e.GUID_PATTERN,e.GUID_REPLACEMENT);switch(d){case e.ACCELEROMETER_UUID_SERVICE:a.Accelerometer.init(c);break;case e.BAROMETRICPRESSURE_UUID_SERVICE:a.BarometricPressure.init(c);break;case e.GYROSCOPE_UUID_SERVICE:a.Gyroscope.init(c);break;case e.HUMIDITY_UUID_SERVICE:a.Humidity.init(c);break;case e.IRTEMPERATURE_UUID_SERVICE:a.IRTemperature.init(c);break;case e.MAGNETOMETER_UUID_SERVICE:a.Magnetometer.init(c)}e.SIMPLEKEY_UUID_SERVICE.test(d)&&a.SimpleKey.init(c)}a.log("Initialized")};var h=0;g.prototype.discover=function(a,b){var e=this;e.log("Discovering Services"),c(),e.device.services(function(c){d(),e.services=c;for(var f=0;f<c.length;++f){var g=c[f];e.discoverCharacteristics(g,a,b)}0===h&&(e.init(),void 0!==a&&a.call(e))},function(a){d(),e.log("Services error: "+a),void 0!==b&&b.call(e,a)})},g.prototype.discoverCharacteristics=function(a,b,e){var f=this;c(),f.device.characteristics(a,function(c){d(),a.characteristics=c;for(var g=0;g<c.length;++g){var i=c[g];f.discoverDescriptors(i,b,e)}0===h&&(f.init(),void 0!==b&&b.call(f))},function(a){d(),f.log("Characteristics error: "+a),void 0!==e&&e.call(f,a)})},g.prototype.discoverDescriptors=function(a,b,e){var f=this;c(),f.device.descriptors(a,function(c){d(),a.descriptors=c,0===h&&(f.init(),void 0!==b&&b.call(f))},function(a){d(),f.log("Descriptors error: "+a),void 0!==e&&e.call(f,a)})},g.prototype.close=function(){this.device.close()},b.exports=g},{"./Connectors/Connector":1,"./Connectors/EvothingsConnector":2,"./Connectors/NobleConnector":3,"./Constants":4,"./Sensors/Accelerometer":8,"./Sensors/BarometricPressure":9,"./Sensors/Gyroscope":10,"./Sensors/Humidity":11,"./Sensors/Magnetometer":12,"./Sensors/SimpleKey":13}],8:[function(a,b){function c(a,b){var c=1/64,d=b||1,e=a*d*c;return Math.round(100*e)/100}var d=a("../Constants"),e=a("../SensorBase"),f=function(a){e.call(this,"Accelerometer",a,d.ACCELEROMETER_UUID_DATA,d.ACCELEROMETER_UUID_CONF,d.ACCELEROMETER_UUID_PERIOD)};f.prototype=new e,f.prototype.constructor=f,f.prototype.setPeriod=function(a){var b=Math.round(a/10),c=this;c.sensorTag.device.writeCharacteristic(c.characteristics.period,new Uint8Array([b]),function(){c.log("Period set to "+a+"ms")},function(a){c.log("setPeriod error: "+a)})},f.prototype.calculateAcceleration=function(a,b){var d=new Int8Array(a);return{x:c(d[0],b),y:c(d[1],b),z:c(d[2],b)}},b.exports=f},{"../Constants":4,"../SensorBase":5}],9:[function(a,b){var c=a("../Constants"),d=a("../SensorBase"),e=function(a){d.call(this,"BarometricPressure",a,c.BAROMETRICPRESSURE_UUID_DATA,c.BAROMETRICPRESSURE_UUID_CONF,c.BAROMETRICPRESSURE_UUID_PERIOD),this.calibration=[0,0,0,0,0,0,0,0],this.characteristics.calibration=null};e.prototype=new d,e.prototype.constructor=e,e.prototype.init=function(a){for(var b in a.characteristics){var e=a.characteristics[b],f=e.uuid.replace(c.GUID_PATTERN,c.GUID_REPLACEMENT);c.BAROMETRICPRESSURE_UUID_CALIBRATION.test(f)&&(this.characteristics.calibration=e)}d.prototype.init.call(this,a)},e.prototype.readCalibration=function(a,b){var c,d=this,e=2;c=function(a,c){d.log(a+" error: "+c),void 0!==b&&b.call(d,c)},d.sensorTag.device.writeCharacteristic(d.characteristics.config,new Uint8Array([e]),function(){d.sensorTag.device.readCharacteristic(d.characteristics.calibration,function(b){d.calibration=new Uint16Array(b),void 0!==a&&a.call(d,d.calibration)},function(a){c("readCalibration read",a)})},function(a){c("readCalibration write",a)})},e.prototype.enable=function(){this.readCalibration(d.prototype.enable)},e.prototype.calculatePressure=function(a){var b=new Int16Array(a),c=b[0],d=b[1],e=(100*(this.calibration[0]*c/Math.Pow(2,8)+this.calibration[1]*Math.Pow(2,6))/Math.Pow(2,16),this.calibration[2]+this.calibration[3]*c/Math.Pow(2,17)+this.calibration[4]*c/Math.Pow(2,15)*c/Math.Pow(2,19)),f=this.calibration[5]*Math.Pow(2,14)+this.calibration[6]*c/Math.Pow(2,3)+this.calibration[7]*c/Math.Pow(2,15)*c/Math.Pow(2,4);return(e*d+f)/Math.Pow(2,14)},b.exports=e},{"../Constants":4,"../SensorBase":5}],10:[function(a,b){function c(a){var b=a*(500/65536);return Math.round(100*b)/100}var d=a("../Constants"),e=a("../SensorBase"),f=function(a){e.call(this,"Gyroscope",a,d.GYROSCOPE_UUID_DATA,d.GYROSCOPE_UUID_CONF,d.GYROSCOPE_UUID_PERIOD),this.Axis=f.Axis.XYZ};f.Axis={X:1,Y:2,XY:3,Z:4,XZ:5,YZ:6,XYZ:7},f.prototype=new e,f.prototype.constructor=f,f.prototype.enable=function(){e.prototype.enable.call(this,this.Axis)},f.prototype.calculateAxisValue=function(a){var b=new Int16Array(a);return{y:c(b[0]),x:c(b[1]),z:c(b[2])}},b.exports=f},{"../Constants":4,"../SensorBase":5}],11:[function(a,b){var c=a("../Constants"),d=a("../SensorBase"),e=function(a){d.call(this,"Humidity",a,c.HUMIDITY_UUID_DATA,c.HUMIDITY_UUID_CONF,c.HUMIDITY_UUID_PERIOD)};e.prototype=new d,e.prototype.constructor=e,e.prototype.calculateHumidity=function(a){var b,c=new Uint16Array(a);return b=c[1]-c[1]%4,-6+125*(b/65535)},b.exports=e},{"../Constants":4,"../SensorBase":5}],12:[function(a,b){function c(a){return a*(2e3/65336)}var d=a("../Constants"),e=a("../SensorBase"),f=a("./Accelerometer"),g=function(a){e.call(this,"Magnetometer",a,d.MAGNETOMETER_UUID_DATA,d.MAGNETOMETER_UUID_CONF,d.MAGNETOMETER_UUID_PERIOD)};g.prototype=new e,g.prototype.constructor=g,g.prototype.setPeriod=f.prototype.setPeriod,g.prototype.calculateCoordinates=function(a){var b=new Int16Array(a);return{x:c(b[0]),y:c(b[1]),z:c(b[2])}},b.exports=g},{"../Constants":4,"../SensorBase":5,"./Accelerometer":8}],13:[function(a,b){var c=a("../Constants"),d=a("../SensorBase"),e=function(a){d.call(this,"SimpleKey",a,c.SIMPLEKEY_UUID_DATA)};e.Keys={RIGHT:1,LEFT:2,CENTER:4},e.prototype=new d,e.prototype.constructor=e,delete e.prototype.enable,delete e.prototype.disable,b.exports=e},{"../Constants":4,"../SensorBase":5}]},{},["T6zdoz"]);